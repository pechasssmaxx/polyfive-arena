# CONCERNS.md — Technical Debt & Issues

## Tech Debt

| # | Issue | Location | Severity |
|---|-------|----------|----------|
| 1 | Weak type safety — many `any` types and unvalidated casts | `src/` broadly | Medium |
| 2 | Inconsistent error handling — mix of try/catch, silent swallows, and unhandled rejections | Services layer | Medium |
| 3 | Hard-coded constants spread across files instead of centralised config | Various | Low |
| 4 | Race conditions in concurrent market polling | Bot/polling logic | High |
| 5 | Floating-point rounding errors in profit/loss math | Math utilities | Medium |
| 6 | Duplicated logic across similar service modules | Services | Low |

## Known Bugs

| # | Bug | Impact |
|---|-----|--------|
| 1 | Market resolution edge cases not handled (partial fills, cancelled markets) | High |
| 2 | Position randomisation can produce duplicate order IDs under load | Medium |
| 3 | Token/auth caching does not invalidate on expiry correctly | Medium |
| 4 | Weak authentication checks on internal API routes | High |

## Security Concerns

| # | Issue | Risk |
|---|-------|------|
| 1 | API keys / private keys stored in plaintext `.env` without rotation strategy | Critical |
| 2 | CORS misconfiguration — overly permissive origins | High |
| 3 | No rate limiting on outbound API calls — risk of ban/block | Medium |
| 4 | RPC endpoint hardcoded — single point of failure and exposure | Medium |

## Performance Bottlenecks

| # | Issue | Impact |
|---|-------|--------|
| 1 | Missing database indexes on frequently queried columns | High |
| 2 | No data retention / cleanup policy — DB grows unbounded | Medium |
| 3 | Duplicate polling loops across modules waste API quota | Medium |
| 4 | Cache TTLs too short — excessive API round-trips | Medium |
| 5 | No pagination on large result sets from Polymarket API | Medium |
| 6 | Synchronous file I/O in hot paths | Low |
| 7 | No connection pooling for database | Medium |

## Fragile Areas

| # | Area | Why Fragile |
|---|------|-------------|
| 1 | Config parsing — no schema validation on startup | Silent misconfiguration |
| 2 | Market heuristics — brittle string matching for category detection | Breaks on API changes |
| 3 | Complex math in strategy logic — hard to test/verify | Silent calculation errors |
| 4 | DB migrations — no rollback strategy | Data loss risk on bad migration |
| 5 | Error recovery in bot loop — single error can halt all trading | Availability risk |

## Scaling Limits

| # | Limit | Threshold |
|---|-------|-----------|
| 1 | SQLite write locks under concurrent access | ~10 concurrent writes |
| 2 | Potential memory leaks in long-running WebSocket connections | Hours/days uptime |
| 3 | No WebSocket backpressure handling | High-volume feeds |
| 4 | Single price feed — no fallback provider | Feed outage = blind trading |

## Dependency Risks

| # | Dependency | Risk |
|---|------------|------|
| 1 | Outdated packages with known CVEs (needs `npm audit`) | Security |
| 2 | Native compilation dependencies (possible build failures on env change) | Portability |
| 3 | Large bundle size — no tree-shaking or lazy loading | Performance |
| 4 | Tight coupling to Polymarket SDK version | Breaking changes risk |

## Missing Critical Features

| # | Feature | Impact |
|---|---------|--------|
| 1 | Slippage tracking — no measurement of execution vs. quoted price | P&L accuracy |
| 2 | Position sizing limits — no max exposure per market | Risk management |
| 3 | Fraud/manipulation detection | Trading safety |
| 4 | Hard risk limits (max drawdown, daily loss cap) | Capital safety |
| 5 | Fee accounting in P&L calculations | Reporting accuracy |
| 6 | Automated test suite | Regression safety |

## Test Coverage Gaps

- Order execution logic (unit tests absent)
- Deduplication / idempotency logic
- SSE / streaming event handling
- Migration scripts
- Concurrency / race condition scenarios
- Error path coverage in all services

---
*Generated by gsd-codebase-mapper — concerns focus*
